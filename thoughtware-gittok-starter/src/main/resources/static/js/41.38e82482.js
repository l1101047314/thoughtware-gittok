(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{1218:function(e,t,n){"use strict";n.r(t);n(987);var r=n(767),a=n.n(r),l=n(0),u=n.n(l),i=n(58);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.default=Object(i.inject)("privilegeDomainRoleStore","repositoryStore")(Object(i.observer)((function(e){var t=e.match,n=e.repositoryStore,r=n.findRepositoryByAddress,i=n.repositoryInfo,c="".concat(t.params.namespace,"/").concat(t.params.name);return Object(l.useEffect)((function(){r(c)}),[]),u.a.createElement(a.a,o({},e,{domainId:i.rpyId,bgroup:"gittok",__source:{fileName:"/Users/limingliang/xcode-xpack/web/thoughtware-gittok-ui/src/repository/setting/user/RepositoryRole.js",lineNumber:24,columnNumber:9}}))})))},190:function(e,t){function n(){return e.exports=n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,n.apply(this,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},656:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BaseModal",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"BreadCrumb",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"Btn",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"ListAction",{enumerable:!0,get:function(){return c.ListAction}}),Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"Profile",{enumerable:!0,get:function(){return u.default}});var a=r(n(690)),l=r(n(706)),u=r(n(708)),i=r(n(710)),o=r(n(689)),c=n(712)},689:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(49);var a=r(n(28)),l=r(n(0));n(704);t.default=function(e){var t=e.icon,n=e.type,r=e.title,u=e.onClick,i=e.isMar,o=e.children;return l.default.createElement("div",{className:"privilege-btn ".concat(n?"privilege-btn-".concat(n):""," ").concat(i?"privilege-btn-mar":""),onClick:u},l.default.createElement(a.default,null,t&&l.default.createElement("span",{className:"privilege-btn-icon"},t),o||r))}},690:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(147);var a=r(n(122)),l=r(n(190)),u=r(n(148)),i=r(n(0)),o=r(n(689));n(705);var c=["children"];t.default=function(e){var t=e.children,n=(0,u.default)(e,c),r=i.default.createElement(i.default.Fragment,null,i.default.createElement(o.default,{onClick:n.onCancel,title:"取消",isMar:!0}),i.default.createElement(o.default,{onClick:n.onOk,title:"确定",type:"primary"}));return i.default.createElement(a.default,(0,l.default)({style:{maxWidth:"calc(100vw - 120px)",maxHeight:"calc(100vh - 120px)",marginRight:"auto",marginLeft:"auto",position:"absolute",top:60,right:0,left:0,height:"100%",display:"flex",flexDirection:"column"},wrapClassName:"thoughtware_privilege_modal",closable:!1,destroyOnClose:!0,footer:r},n),t)}},696:function(e,t){e.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},701:function(e,t,n){"use strict";var r=n(20),a=n(44);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(68);var l=r(n(43)),u=r(n(193)),i=r(n(35)),o=r(n(191)),c=r(n(39));n(195);var d=r(n(52)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),s=n(7),m=n(656);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=d.default.Group;t.default=function(e){var t=e.roleDetail,n=e.type,r=(0,f.useState)(!1),a=(0,c.default)(r,2),i=a[0],p=a[1],v=(0,f.useState)([]),y=(0,c.default)(v,2),h=y[0],O=y[1],E=(0,f.useState)({}),P=(0,c.default)(E,2),j=P[0],_=P[1],w=(0,f.useState)([]),k=(0,c.default)(w,2),D=k[0],x=k[1],R=(0,f.useState)({}),S=(0,c.default)(R,2),I=(S[0],S[1]),M=[{title:"模块",key:"label",width:"30%",render:function(e){return f.default.createElement(d.default,{disabled:!i,indeterminate:e.indeterminate,onChange:function(t){return T(t,e)},checked:e.checkAll},e.label)}},{title:"功能点",key:"name",render:function(e){return f.default.createElement("div",{className:"privilege-role-promise"},f.default.createElement(b,{disabled:!i,options:j[e.value],value:e.checkedList,onChange:function(t){return B(t,e)}}))}}];(0,f.useEffect)((function(){null!=t&&t.id&&N()}),[null==t?void 0:t.id]);var N=function(){var e;e="system"===n?{group:null==t?void 0:t.group}:{type:"2"},s.Axios.post("/function/findFunctionList",e).then((function(e){if(!e.code){var t=C(e.data);O(t.result),_(t.resultChild),L(!0,t.result,t.resultChild)}}))},C=function(e){var t=e.map((function(e){return!e.parentFunction&&{value:e.id,label:e.name}})).filter(Boolean),n=e.map((function(e){return e.parentFunction&&e.parentFunction.id&&{value:e.id,label:e.name,parent:e.parentFunction.id}})).filter(Boolean),r=[],a={};return t.forEach((function(e){var t=e.value,l=n.filter((function(e){return e.parent===t}));r.push({value:e.value,label:e.label,indeterminate:!1,checkedList:[],checkAll:!1}),a[e.value]=l})),{result:r,resultChild:a}},A=function(e){var t=e.filter((function(e){return e.function&&e.function.parentFunction})).map((function(e){return{parentID:e.function.parentFunction.id,id:e.function.id}})),n=e.filter((function(e){return!e.function.parentFunction})).map((function(e){return e.function.id})),r={};return n.forEach((function(e){var n=t.map((function(t){if(t.parentID===e)return t.id})).filter(Boolean);r[e]=[].concat((0,o.default)(n),[e])})),r},L=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l={roleId:"domain"===n?t.role.id:t.id};s.Axios.post("roleFunction/findRoleFunctionList",l).then((function(t){if(!t.code){var n=A(t.data),l=t.data.reduce((function(e,t){return e[t.function.id]=t.id,e}),{}),u=e?a:j,i=(e?r:h).map((function(e){var t=n[e.value]?n[e.value]:[],r=0===u[e.value].length,a=t.length===u[e.value].length+1&&0!==t.length,l=a?!a:!!t.length&&t.length<u[e.value].length+1;return r&&1===t.length&&(a=!0,l=!1),g(g({},e),{},{checkedList:t,indeterminate:l,checkAll:a})}));I(l),O(i),x(t.data.map((function(e){return e.function.id})))}}))},B=function(e,t){W(e,t)},W=function(e,t){var n=h.map((function(n){if(n.value===t.value){if(0===e.length)return F(t,"delete"),g(g({},n),{},{checkedList:[],checkAll:!1,indeterminate:!1});if(e.length===j[t.value].length)return F(t,"add"),g(g({},n),{},{checkedList:e,checkAll:!0,indeterminate:!1});if(e.length<j[t.value].length)return F(t,"filterAdd",e),g(g({},n),{},{checkedList:e,checkAll:!1,indeterminate:!0})}return n}));O(n)},F=function(e,t,n){var r,a=j[e.value].map((function(e){return e.value})).filter(Boolean),l=[].concat((0,o.default)(a),[e.value]);if("add"===t)r=Array.from(new Set([].concat((0,o.default)(D),(0,o.default)(l))));else if("delete"===t)r=D.filter((function(e){return!l.includes(e)}));else{var u=D.filter((function(e){return!a.includes(e)}));r=Array.from(new Set([].concat((0,o.default)(u),(0,o.default)(n),[e.value])))}x(r)},T=function(e,t){var n=D.includes(t.value),r=h.map((function(e){if(e.value===t.value){if(F(t,n?"delete":"add"),n)return g(g({},e),{},{checkedList:[],checkAll:!1,indeterminate:!1});var r=j[t.value].map((function(e){return e.value})).filter(Boolean);return g(g({},e),{},{checkedList:r,checkAll:!0,indeterminate:!1})}return e}));O(r)},U=function(){L(),p(!1)},z=function(){var e={role:{id:"domain"===n?t.role.id:t.id},functionList:D};s.Axios.post("roleFunction/updateRoleAllFunction",e).then((function(e){0===e.code&&L(),p(!1)}))};return f.default.createElement("div",{className:"thoughtware_role_promisse"},i?f.default.createElement("div",{className:"thoughtware_role_promisse_up"},f.default.createElement(m.Btn,{onClick:U,isMar:!0},"取消"),f.default.createElement(m.Btn,{type:"primary",onClick:z},"保存")):f.default.createElement("div",{className:"thoughtware_role_promisse_up"},f.default.createElement(m.Btn,{onClick:function(){return p(!0)},icon:f.default.createElement(u.default,null)},"编辑")),f.default.createElement("div",{className:"thoughtware_role_promisse_table"},f.default.createElement(l.default,{pagination:!1,columns:M,dataSource:h,rowKey:function(e){return e.value},bordered:!0})),i&&f.default.createElement("div",{className:"thoughtware_role_promisse_bottom"},f.default.createElement(m.Btn,{onClick:U,isMar:!0},"取消"),f.default.createElement(m.Btn,{type:"primary",onClick:z},"保存")))}},704:function(e,t,n){"use strict";n.r(t)},705:function(e,t,n){"use strict";n.r(t)},706:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(49);var a=r(n(28)),l=r(n(216)),u=r(n(0));n(707);t.default=function(e){var t=e.firstItem,n=e.secondItem,r=e.children,i=e.onClick;return u.default.createElement("div",{className:"privilege-breadcrumb"},u.default.createElement(a.default,null,u.default.createElement("span",{className:i?"privilege-breadcrumb-first":"",onClick:i},i&&u.default.createElement(l.default,{style:{marginRight:8}}),u.default.createElement("span",{className:n?"privilege-breadcrumb-span":""},t)),n&&u.default.createElement("span",null," /   ",n)),u.default.createElement("div",null,r))}},707:function(e,t,n){"use strict";n.r(t)},708:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(304));n(194);var l=r(n(102)),u=r(n(0)),i=n(7);n(709);t.default=function(e){var t=e.userInfo,n=void 0===t?void 0:t,r=n||(0,i.getUser)();return u.default.createElement("div",{className:"thoughtware-profile"},r.avatar&&"null"!==r.avatar?u.default.createElement(l.default,{src:r.avatar}):r.nickname&&"null"!==r.nickname?u.default.createElement(l.default,null,r.nickname.substring(0,1)):r.name&&"null"!==r.name?u.default.createElement(l.default,null,r.name.substring(0,1)):u.default.createElement(l.default,{size:32,icon:u.default.createElement(a.default,null)}))}},709:function(e,t,n){"use strict";n.r(t)},710:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(302)),l=r(n(216)),u=r(n(0));n(711);t.default=function(e){var t=e.currentPage,n=e.changPage,r=e.page,i=r.totalPage,o=void 0===i?1:i,c=r.totalRecord,d=void 0===c?1:c;return o>1&&u.default.createElement("div",{className:"privilege-page"},u.default.createElement("div",{className:"".concat(1===t?"privilege-page-ban":"privilege-page-allow"),onClick:function(){return 1===t?null:n(t-1)}},u.default.createElement(l.default,null)),u.default.createElement("div",{className:"privilege-page-current"},t),u.default.createElement("div",{className:"privilege-page-line"}," / "),u.default.createElement("div",null,o),u.default.createElement("div",{className:"".concat(t===o?"privilege-page-ban":"privilege-page-allow"),onClick:function(){return t===o?null:n(t+1)}},u.default.createElement(a.default,null)),u.default.createElement("div",{className:"privilege-page-record"},"  共",d,"条 "))}},711:function(e,t,n){"use strict";n.r(t)},712:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ListAction",{enumerable:!0,get:function(){return a.default}});var a=r(n(713))},713:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(192);var a=r(n(149)),l=r(n(123));n(147);var u=r(n(122));n(101);var i=r(n(59)),o=r(n(193)),c=r(n(0));n(714);t.default=function(e){var t=e.edit,n=e.del;return c.default.createElement("span",{className:"privilege-listAction"},t&&c.default.createElement(i.default,{title:"修改"},c.default.createElement("span",{onClick:t,className:"edit",style:{cursor:"pointer",marginRight:15}},c.default.createElement(o.default,{style:{fontSize:16}}))),n&&c.default.createElement(a.default,{overlay:c.default.createElement("div",{className:"privilege-dropdown-more"},c.default.createElement("div",{className:"dropdown-more-item",onClick:function(){u.default.confirm({title:"确定删除吗？",content:c.default.createElement("span",{style:{color:"#f81111"}},"删除后无法恢复！"),okText:"确认",cancelText:"取消",onOk:function(){n()},onCancel:function(){}})}},"删除")),trigger:["click"],placement:"bottomRight"},c.default.createElement(i.default,{title:"更多"},c.default.createElement("span",{className:"del",style:{cursor:"pointer"}},c.default.createElement(l.default,{style:{fontSize:17}})))))}},714:function(e,t,n){"use strict";n.r(t)},720:function(e,t,n){"use strict";var r=n(20),a=n(44);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(190));n(68);var u=r(n(43)),i=r(n(135));n(49);var o=r(n(28));n(215);var c=r(n(95)),d=r(n(39)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),s=n(58),m=r(n(721)),p=n(656),v=n(136);function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}t.default=(0,s.inject)(v.PRIVILEGE_DOMAIN_ROLE_STORE)((0,s.observer)((function(e){var t=e.dmRoleDetail,n=e.domainId,r=e.privilegeDomainRoleStore,a=r.deleteDmRoleUserAction,s=r.findDmRoleUserListAction,v=(0,f.useState)([]),g=(0,d.default)(v,2),b=g[0],y=g[1],h=(0,f.useState)(!1),O=(0,d.default)(h,2),E=O[0],P=O[1],j=[{title:"姓名",dataIndex:["user","nickname"],key:["user","nickname"],width:"25%",ellipsis:!0,render:function(e,t){return f.default.createElement(o.default,null,e||"--",1===t.type&&f.default.createElement(c.default,null,"管理员用户"))}},{title:"用户名",dataIndex:["user","name"],key:["user","name"],width:"20%",ellipsis:!0,render:function(e){return e||"--"}},{title:"手机号",dataIndex:["user","phone"],key:["user","phone"],width:"20%",ellipsis:!0,render:function(e){return e||"--"}},{title:"邮箱",dataIndex:["user","email"],key:["user","email"],width:"25%",ellipsis:!0,render:function(e){return e||"--"}},{title:"操作",dataIndex:"action",width:"10%",render:function(e,n){var r=n.user;return 0===(null==t?void 0:t.businessType)||(null==t?void 0:t.businessType)>0&&(null==r?void 0:r.type)<1?f.default.createElement(p.ListAction,{del:function(){return w(n.id)}}):null}}];(0,f.useEffect)((function(){null!=t&&t.id&&_()}),[null==t?void 0:t.id]);var _=function(){s({dmRoleId:t.id}).then((function(e){e.code||y(e.data)}))},w=function(e){a(e).then((function(e){e.code||_()}))};return f.default.createElement("div",{className:"thoughtware_dm_promisse"},f.default.createElement("div",{className:"thoughtware_dm_promisse_up"},f.default.createElement("div",{className:"thoughtware_dm_promisse_up-title"},"用户(",b.length,")"),f.default.createElement("div",null,f.default.createElement(p.Btn,{onClick:function(){return P(!0)},type:"primary",title:"添加用户",icon:f.default.createElement(i.default,null)}))),f.default.createElement("div",{className:"thoughtware_dm_promisse_person"},f.default.createElement(u.default,{columns:j,dataSource:b,rowKey:function(e){return e.id},pagination:!1})),f.default.createElement(m.default,(0,l.default)({},e,{visible:E,setVisible:P,getFindDmRoleUserList:_,dmRoleId:t.id,cardData:b,domainId:n})))})))},721:function(e,t,n){"use strict";var r=n(20),a=n(44);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(217)),u=r(n(39)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),o=n(772);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}t.default=function(e){var t=e.visible,n=e.setVisible,r=e.dmRoleId,a=void 0===r?"":r,c=e.cardData,d=e.domainId,f=e.getFindDmRoleUserList,s=e.privilegeDomainRoleStore.createBatchDmRoleUserAction,m=(0,i.useState)([]),p=(0,u.default)(m,2),v=p[0],g=p[1],b=(0,i.useState)([]),y=(0,u.default)(b,2),h=y[0],O=y[1];(0,i.useEffect)((function(){t&&c&&(g(c.map((function(e){return e.user.id}))),O(c.map((function(e){return e.user.id}))))}),[t]);var E=function(){g([]),n(!1)};return i.default.createElement(o.UserAdd,{visible:t,addType:"domain",domainId:d,allSelectIds:h,selectedRowKeys:v,setSelectedRowKeys:g,handleOk:function(){s({dmRole:{id:a},domainId:d,userIds:v}).then((function(e){E(),f()}))},handleCancel:E},i.default.createElement("div",{className:"thoughtware_user_add_modal_up"},i.default.createElement("div",null,"添加用户"),i.default.createElement("div",{onClick:function(){return E()}},i.default.createElement(l.default,null))))}},750:function(e,t,n){"use strict";n.r(t)},762:function(e,t,n){"use strict";var r=n(696),a=n.n(r),l=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function u(e){var t={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},n=e.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(t.name=n[1],(a.a[n[1]]||"/"===e.charAt(e.length-2))&&(t.voidElement=!0),t.name.startsWith("!--"))){var r=e.indexOf("--\x3e");return{type:"comment",comment:-1!==r?e.slice(4,r):""}}for(var u=new RegExp(l),i=null;null!==(i=u.exec(e));)if(i[0].trim())if(i[1]){var o=i[1].trim(),c=[o,""];o.indexOf("=")>-1&&(c=o.split("=")),t.attrs[c[0]]=c[1],u.lastIndex--}else i[2]&&(t.attrs[i[2]]=i[3].trim().substring(1,i[3].length-1));return t}var i=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,o=/^\s*$/,c=Object.create(null);function d(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?function(e){var t=[];for(var n in e)t.push(n+'="'+e[n]+'"');return t.length?" "+t.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(d,"")+"</"+t.name+">";case"comment":return e+"\x3c!--"+t.comment+"--\x3e"}}var f={parse:function(e,t){t||(t={}),t.components||(t.components=c);var n,r=[],a=[],l=-1,d=!1;if(0!==e.indexOf("<")){var f=e.indexOf("<");r.push({type:"text",content:-1===f?e:e.substring(0,f)})}return e.replace(i,(function(i,c){if(d){if(i!=="</"+n.name+">")return;d=!1}var f,s="/"!==i.charAt(1),m=i.startsWith("\x3c!--"),p=c+i.length,v=e.charAt(p);if(m){var g=u(i);return l<0?(r.push(g),r):((f=a[l]).children.push(g),r)}if(s&&(l++,"tag"===(n=u(i)).type&&t.components[n.name]&&(n.type="component",d=!0),n.voidElement||d||!v||"<"===v||n.children.push({type:"text",content:e.slice(p,e.indexOf("<",p))}),0===l&&r.push(n),(f=a[l-1])&&f.children.push(n),a[l]=n),(!s||n.voidElement)&&(l>-1&&(n.voidElement||n.name===i.slice(2,-1))&&(l--,n=-1===l?r:a[l]),!d&&"<"!==v&&v)){f=-1===l?r:a[l].children;var b=e.indexOf("<",p),y=e.slice(p,-1===b?void 0:b);o.test(y)&&(y=" "),(b>-1&&l+f.length>=0||" "!==y)&&f.push({type:"text",content:y})}})),r},stringify:function(e){return e.reduce((function(e,t){return e+d("",t)}),"")}};t.a=f},767:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(768));t.default=a.default},768:function(e,t,n){"use strict";var r=n(20),a=n(44);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(87));n(69);var u=r(n(40)),i=r(n(190));n(74);var o=r(n(34));n(68);var c=r(n(43)),d=r(n(135)),f=r(n(88)),s=r(n(35));n(101);var m=r(n(59)),p=r(n(497));n(49);var v=r(n(28));n(215);var g=r(n(95)),b=r(n(39)),y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=j(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),h=n(58),O=n(45),E=n(769),P=n(656);function j(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(j=function(e){return e?n:t})(e)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(750);t.default=(0,h.inject)("privilegeDomainRoleStore")((0,h.observer)((function(e){var t=(0,O.useTranslation)().t,n=e.privilegeDomainRoleStore,r=e.domainId,a=n.privilegeDomainRole,s=n.deleteDomainRoleAction,h=n.setDomainRoleAction,j=n.findDomainRolePageAction,_=n.domainRolePage,k=(0,y.useState)(!1),D=(0,b.default)(k,2),x=D[0],R=D[1],S=(0,y.useState)({pageSize:12,currentPage:1}),I=(0,b.default)(S,1)[0],M=(0,y.useState)({pageParam:I}),N=(0,b.default)(M,2),C=N[0],A=N[1],L=(0,y.useState)(null),B=(0,b.default)(L,2),W=B[0],F=B[1],T=[{title:"角色名称",dataIndex:"name",width:"40%",ellipsis:!0,render:function(e,t){var n=t.businessType,r=t.role;return 1===n&&1===r.defaultRole?y.default.createElement(v.default,null,y.default.createElement("div",{className:"thoughtware_domain_role_name",onClick:function(){return K(t)}},r.name),y.default.createElement(g.default,{color:"#87d068"},"默认"),y.default.createElement(g.default,null,"管理员")):1===r.defaultRole?y.default.createElement(v.default,null,y.default.createElement("div",{className:"thoughtware_domain_role_name",onClick:function(){return K(t)}},r.name),y.default.createElement(g.default,{color:"#87d068"},"默认")):1===n?y.default.createElement(v.default,null,y.default.createElement("div",{className:"thoughtware_domain_role_name",onClick:function(){return K(t)}},r.name),y.default.createElement(g.default,null,"管理员")):y.default.createElement("div",{className:"thoughtware_domain_role_name",onClick:function(){return K(t)}},r.name)}},{title:"成员数",dataIndex:"roleUserList",width:"25%",ellipsis:!0,render:function(e,t){var n=t.dmRoleUserList,r=n&&n.length>0?n.length:0;return"".concat(r,"人")}},{title:"角色类型",dataIndex:["role","group"],width:"25%",ellipsis:!0,render:function(e){return"system"===e?"内置":t("privilege-role.custom")}},{title:"操作",dataIndex:"action",render:function(e,t){var n=t.role,r=t.businessType,a=t.id;return y.default.createElement(v.default,null,0===(null==n?void 0:n.defaultRole)&&y.default.createElement(m.default,{title:"设置默认"},y.default.createElement(p.default,{onClick:function(){return z(t)},style:{fontSize:"var(--thoughtware-icon-size-16)"}})),0===r&&"system"!==n.group&&y.default.createElement(P.ListAction,{del:function(){return V(a)}}))}}];(0,y.useEffect)((function(){U()}),[C]);var U=function(){j(w(w({},C),{},{domainId:r}))},z=function(){var e=(0,f.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:e.sent.code||U();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(e){F(e)},V=function(){var e=(0,f.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:0===e.sent.code&&U();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return y.default.createElement(u.default,{className:"thoughtware_domain_role"},y.default.createElement(o.default,{sm:{span:"24"},md:{span:"24"},lg:{span:"24"},xl:{span:"18",offset:"3"},xxl:{span:"18",offset:"3"}},W?y.default.createElement(E.DmRoleDetail,{roleDetailParams:W,domainId:r,setDetail:F,getProjectDmRole:U}):y.default.createElement("div",{className:"thoughtware_domain_role-content"},y.default.createElement(P.BreadCrumb,{firstItem:"权限"},y.default.createElement(P.Btn,{onClick:function(){return R(!0)},type:"primary",icon:y.default.createElement(d.default,null),title:t("privilege-role.addRole")})),y.default.createElement(c.default,{columns:T,dataSource:a,rowKey:function(e){return e.id},pagination:!1}),y.default.createElement(P.Page,{currentPage:C.pageParam.currentPage,changPage:function(e){A(w(w({},C),{},{pageParam:{pageSize:12,currentPage:e}}))},page:_}))),y.default.createElement(E.DmRoleCreate,(0,i.default)({},e,{visible:x,domainId:r,handleCancel:function(){return R(!1)},getProjectDmRole:U})))})))},769:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DmRoleCreate",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"DmRoleDetail",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"DmRolePeople",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"DomainRoleUserCreate",{enumerable:!0,get:function(){return i.default}});var a=r(n(770)),l=r(n(771)),u=r(n(720)),i=r(n(721))},770:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(42);var a=r(n(18)),l=r(n(35));n(56);var u=r(n(15)),i=r(n(39)),o=r(n(0)),c=n(45),d=n(656);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(e){var t=e.visible,n=e.handleCancel,r=e.getProjectDmRole,l=e.domainId,f=e.privilegeDomainRoleStore.createDomainRoleAction,m=(0,c.useTranslation)().t,p=u.default.useForm(),v=(0,i.default)(p,1)[0];return o.default.createElement(d.BaseModal,{title:"添加角色",visible:t,onCancel:n,onOk:function(){v.submit()},destroyOnClose:!0},o.default.createElement(u.default,{form:v,preserve:!1,onFinish:function(e){var t={domainId:l,businessType:0,role:s({},e)};f(t).then((function(e){0===e.code&&(n(),r())}))},layout:"vertical"},o.default.createElement(u.default.Item,{label:m("privilege-role.roleName"),name:"name",rules:[{required:!0,message:"用户名不能包含非法字符，如&,%，&，#……等"}]},o.default.createElement(a.default,{placeholder:m("privilege-role.roleName")})),o.default.createElement(u.default.Item,{label:m("privilege-desc"),name:"desc"},o.default.createElement(a.default,{placeholder:m("privilege-desc")}))))}},771:function(e,t,n){"use strict";var r=n(20),a=n(44);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(190));n(42);var u=r(n(18)),i=r(n(35)),o=r(n(39));n(759);var c=r(n(757)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),f=n(45),s=r(n(720)),m=n(656),p=r(n(701)),v=n(7);function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=c.default.TabPane;t.default=function(e){var t,n,r,a,g=e.roleDetailParams,b=e.domainId,O=e.setDetail,E=e.getProjectDmRole,P=(0,f.useTranslation)().t,j=(0,d.useState)(null),_=(0,o.default)(j,2),w=_[0],k=_[1],D=function(e,t){if(k(null),g.role[t]!==e.target.value){e.target.value||"name"!==t||O(g);var n=g.role,r={domainId:b,id:g.id,role:y(y({},n),{},(0,i.default)({},t,e.target.value))};v.Axios.post("/dmRole/updateDmRole",r).then((function(r){0===r.code&&(O(y(y({},g),{},{role:y(y({},n),{},(0,i.default)({},t,e.target.value))})),E())}))}};return d.default.createElement("div",{className:"thoughtware_domain_role_detail"},d.default.createElement(m.BreadCrumb,{firstItem:(null==g||null===(t=g.role)||void 0===t?void 0:t.name)||"权限详情",onClick:function(){return O(null)}}),d.default.createElement("div",{className:"detail-title"},d.default.createElement("div",{className:"label_item"},d.default.createElement("div",null,"名称"),d.default.createElement("div",null,d.default.createElement(u.default,{bordered:"name"===w,defaultValue:null==g||null===(n=g.role)||void 0===n?void 0:n.name,className:"".concat("name"===w?"":"label_item_name"),onFocus:function(){return k("name")},onBlur:function(e){return D(e,"name")},onPressEnter:function(e){return e.target.blur()}}))),d.default.createElement("div",{className:"label_item"},d.default.createElement("div",null,"类型"),d.default.createElement("div",{className:"label_item_type"},"system"===(null==g||null===(r=g.role)||void 0===r?void 0:r.group)?"内置":"自定义"))),d.default.createElement("div",{className:"label_item label_desc"},d.default.createElement("div",null,"描述"),d.default.createElement("div",null,d.default.createElement(u.default.TextArea,{bordered:"desc"===w,defaultValue:null==g||null===(a=g.role)||void 0===a?void 0:a.desc,className:"".concat("desc"===w?"":"label_item_name"),onFocus:function(){return k("desc")},onBlur:function(e){return D(e,"desc")},autoSize:{minRows:1,maxRows:4}}))),d.default.createElement(c.default,{defaultActiveKey:"people"},d.default.createElement(h,{tab:P("privilege-role.people"),key:"people"},d.default.createElement(s.default,(0,l.default)({},e,{domainId:b,dmRoleDetail:g}))),d.default.createElement(h,{tab:P("privilege-role.promise"),key:"promise"},d.default.createElement(p.default,{type:"domain",roleDetail:g}))))}},772:function(e,t,n){"use strict";var r=n(20);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"UserAdd",{enumerable:!0,get:function(){return a.default}});var a=r(n(773))},773:function(e,t,n){"use strict";var r=n(20),a=n(44);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(87));n(68);var u=r(n(43));n(42);var i=r(n(18)),o=r(n(150));n(49);var c=r(n(28)),d=r(n(191)),f=r(n(35)),s=r(n(88)),m=r(n(39)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=b(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),v=n(58),g=n(656);function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(b=function(e){return e?n:t})(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,f.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=(0,v.inject)("systemRoleStore","privilegeDomainRoleStore")((0,v.observer)((function(e){var t=e.visible,n=e.handleOk,r=e.handleCancel,a=e.allSelectIds,f=e.addType,v=e.domainId,b=e.selectedRowKeys,y=e.setSelectedRowKeys,O=e.systemRoleStore,E=e.privilegeDomainRoleStore,P=O.getUserPageAction,j=E.findDmUserPageAction,_=(0,p.useState)([]),w=(0,m.default)(_,2),k=w[0],D=w[1],x={pageSize:6,currentPage:1},R=(0,p.useState)({}),S=(0,m.default)(R,2),I=S[0],M=S[1],N=(0,p.useState)({pageParam:x}),C=(0,m.default)(N,2),A=C[0],L=C[1];(0,p.useEffect)((function(){B().then((function(e){var t;if(0===e.code&&(M({currentPage:e.data.currentPage,totalPage:e.data.totalPage,totalRecord:e.data.totalRecord}),null!==(t=e.data)&&void 0!==t&&t.dataList)){var n=e.data.dataList;D("system"===f?n:n.map((function(e){return e.user})))}}))}),[A]);var B=function(){var e=(0,s.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("system"!==f){e.next=6;break}return e.next=3,P(A);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,j(h(h({},A),{},{domainId:v}));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(e){return a&&a.some((function(t){return t===e.id}))},F={selectedRowKeys:b,onSelectAll:function(e,t,n){var r=n.map((function(e){return e&&e.id})).filter((function(e){return void 0!==e}));if(e){var a=Array.from(new Set([].concat((0,d.default)(r),(0,d.default)(b))));y(a)}else{var l=b.filter((function(e){return!r.includes(e)}));y(l)}},onSelect:function(e){return T(e)},getCheckboxProps:function(e){return{disabled:W(e)}}},T=function(e){W(e)||(b.indexOf(e.id)>=0?b.splice(b.indexOf(e.id),1):b.push(e.id),y((0,d.default)(b)))},U=[{title:"姓名",dataIndex:"nickname",key:"nickname",width:"25%",ellipsis:!0,render:function(e,t){return p.default.createElement(c.default,null,p.default.createElement(g.Profile,{userInfo:t}),e)}},{title:"用户名",dataIndex:"name",key:"name",width:"25%",ellipsis:!0,render:function(e){return e||"--"}},{title:"手机号",dataIndex:"phone",key:"phone",width:"25%",ellipsis:!0,render:function(e){return e||"--"}},{title:"邮箱",dataIndex:"email",key:"email",width:"25%",ellipsis:!0,render:function(e){return e||"--"}}];return p.default.createElement(g.BaseModal,{visible:t,onCancel:r,onOk:n,width:700,title:"添加用户"},p.default.createElement("div",null,p.default.createElement(i.default,{placeholder:"姓名、用户名、手机号、邮箱",style:{width:240},onPressEnter:function(e){return function(e){var t=h(h({},A),{},{accent:e.target.value,pageParam:x});L(t)}(e)},prefix:p.default.createElement(o.default,{style:{fontSize:"var(--thoughtware-icon-size-16)"}})}),p.default.createElement("div",{style:{paddingTop:10}},p.default.createElement(u.default,{columns:U,dataSource:k,rowSelection:F,onRow:function(e){return{onClick:function(){return T(e)}}},rowKey:function(e){return e.id},pagination:!1}),p.default.createElement(g.Page,{currentPage:A.pageParam.currentPage,changPage:function(e){var t=h(h({},A),{},{pageParam:{pageSize:6,currentPage:e}});L(t)},page:I}))))})))},987:function(e,t,n){"use strict";n(750)}}]);