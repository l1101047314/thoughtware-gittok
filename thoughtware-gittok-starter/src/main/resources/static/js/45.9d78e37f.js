(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{1215:function(e,t,n){"use strict";n.r(t);n(970);var r=n(745),a=n.n(r),l=n(0),u=n.n(l),i=n(67);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.default=Object(i.inject)("privilegeDomainRoleStore","repositoryStore")(Object(i.observer)((function(e){var t=e.match,n=e.repositoryStore,r=n.findRepositoryByAddress,i=n.repositoryInfo,c="".concat(t.params.namespace,"/").concat(t.params.name);return Object(l.useEffect)((function(){r(c)}),[]),u.a.createElement(a.a,o({},e,{domainId:i.rpyId,bgroup:"gittok",__source:{fileName:"/Users/limingliang/xcode-xpack/thoughtware-gittork-ui/src/repository/setting/user/RepositoryRole.js",lineNumber:24,columnNumber:9}}))})))},192:function(e,t){function n(){return e.exports=n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,n.apply(this,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},637:function(e,t,n){"use strict";var r=n(21);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BaseModal",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"BreadCrumb",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"Btn",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"Profile",{enumerable:!0,get:function(){return u.default}});var a=r(n(683)),l=r(n(686)),u=r(n(688)),i=r(n(690)),o=r(n(671))},671:function(e,t,n){"use strict";var r=n(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(45);var a=r(n(24)),l=r(n(0));n(684);t.default=function(e){var t=e.icon,n=e.type,r=e.title,u=e.onClick,i=e.isMar,o=e.children;return l.default.createElement("div",{className:"privilege-btn ".concat(n?"privilege-btn-".concat(n):""," ").concat(i?"privilege-btn-mar":""),onClick:u},l.default.createElement(a.default,null,t&&l.default.createElement("span",{className:"privilege-btn-icon"},t),o||r))}},675:function(e,t){e.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},679:function(e,t,n){"use strict";var r=n(21),a=n(46);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(88));n(59);var u=r(n(39));n(50);var i=r(n(18)),o=r(n(151));n(45);var c=r(n(24)),d=r(n(193)),f=r(n(38)),s=r(n(89)),m=r(n(43)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=b(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),v=n(67),g=n(637);function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(b=function(e){return e?n:t})(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,f.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=(0,v.inject)("systemRoleStore","privilegeDomainRoleStore")((0,v.observer)((function(e){var t=e.visible,n=e.handleOk,r=e.handleCancel,a=e.allSelectIds,f=e.addType,v=e.domainId,b=e.selectedRowKeys,h=e.setSelectedRowKeys,O=e.systemRoleStore,E=e.privilegeDomainRoleStore,P=O.getUserPageAction,j=E.findDmUserPageAction,_=(0,p.useState)([]),w=(0,m.default)(_,2),k=w[0],D=w[1],x=(0,p.useState)({pageSize:6,currentPage:1}),R=(0,m.default)(x,1)[0],S=(0,p.useState)(1),I=(0,m.default)(S,2),M=I[0],C=I[1],N=(0,p.useState)({}),A=(0,m.default)(N,2),B=A[0],L=A[1],W=(0,p.useState)({pageParam:R}),F=(0,m.default)(W,2),T=F[0],z=F[1];(0,p.useEffect)((function(){U(T).then()}),[T]);var U=function(){var e=(0,s.default)(l.default.mark((function e(t){var n,r,a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("system"!==f){e.next=6;break}return e.next=3,P(t);case 3:n=e.sent,e.next=9;break;case 6:return e.next=8,j(y(y({},t),{},{domainId:v}));case 8:n=e.sent;case 9:0===n.code&&(L({currentPage:n.data.currentPage,totalPage:n.data.totalPage,totalRecord:n.data.totalRecord}),null!==(r=n.data)&&void 0!==r&&r.dataList&&(a=n.data.dataList,D("system"===f?a:a.map((function(e){return e.user})))));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(e){return a&&a.some((function(t){return t===e.id}))},V={selectedRowKeys:b,onSelectAll:function(e,t,n){var r=n.map((function(e){return e&&e.id})).filter((function(e){return void 0!==e}));if(e){var a=Array.from(new Set([].concat((0,d.default)(r),(0,d.default)(b))));h(a)}else{var l=b.filter((function(e){return!r.includes(e)}));h(l)}},onSelect:function(e){return G(e)},getCheckboxProps:function(e){return{disabled:K(e)}}},G=function(e){K(e)||(b.indexOf(e.id)>=0?b.splice(b.indexOf(e.id),1):b.push(e.id),h((0,d.default)(b)))},J=[{title:"姓名",dataIndex:"nickname",key:"nickname",width:"40%",ellipsis:!0,render:function(e,t){return p.default.createElement(c.default,null,p.default.createElement(g.Profile,{userInfo:t}),e)}},{title:"手机号",dataIndex:"phone",key:"phone",width:"30%",ellipsis:!0,render:function(e){return e||"--"}},{title:"邮箱",dataIndex:"email",key:"email",width:"30%",ellipsis:!0,render:function(e){return e||"--"}}];return p.default.createElement(g.BaseModal,{visible:t,onCancel:r,onOk:n,width:700,title:"添加用户"},p.default.createElement("div",null,p.default.createElement(i.default,{placeholder:"搜索用户名",style:{width:240},onPressEnter:function(e){return function(e){var t=y(y({},T),{},{nickname:e.target.value,pageParam:R});z(t)}(e)},prefix:p.default.createElement(o.default,{style:{fontSize:"var(--thoughtware-icon-size-16)"}})}),p.default.createElement("div",{style:{width:"100%"}},p.default.createElement(u.default,{columns:J,dataSource:k,rowSelection:V,onRow:function(e){return{onClick:function(){return G(e)}}},rowKey:function(e){return e.id},pagination:!1}),p.default.createElement(g.Page,{currentPage:M,changPage:function(e){C(e);var t=y(y({},T),{},{pageParam:{pageSize:6,currentPage:e}});z(t)},page:B}))))})))},680:function(e,t,n){"use strict";var r=n(21),a=n(46);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(59);var l=r(n(39)),u=r(n(218)),i=r(n(38)),o=r(n(193)),c=r(n(43));n(197);var d=r(n(57)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),s=n(7),m=n(637);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=d.default.Group;t.default=function(e){var t=e.roleDetail,n=e.type,r=(0,f.useState)(!1),a=(0,c.default)(r,2),i=a[0],p=a[1],v=(0,f.useState)([]),h=(0,c.default)(v,2),y=h[0],O=h[1],E=(0,f.useState)({}),P=(0,c.default)(E,2),j=P[0],_=P[1],w=(0,f.useState)([]),k=(0,c.default)(w,2),D=k[0],x=k[1],R=(0,f.useState)({}),S=(0,c.default)(R,2),I=(S[0],S[1]),M=[{title:"模块",key:"label",width:"30%",render:function(e){return f.default.createElement(d.default,{disabled:!i,indeterminate:e.indeterminate,onChange:function(t){return T(t,e)},checked:e.checkAll},e.label)}},{title:"功能点",key:"name",render:function(e){return f.default.createElement("div",{className:"privilege-role-promise"},f.default.createElement(b,{disabled:!i,options:j[e.value],value:e.checkedList,onChange:function(t){return L(t,e)}}))}}];(0,f.useEffect)((function(){null!=t&&t.id&&C()}),[null==t?void 0:t.id]);var C=function(){var e;e="system"===n?{group:null==t?void 0:t.group}:{type:"2"},s.Axios.post("/function/findFunctionList",e).then((function(e){if(!e.code){var t=N(e.data);O(t.result),_(t.resultChild),B(!0,t.result,t.resultChild)}}))},N=function(e){var t=e.map((function(e){return!e.parentFunction&&{value:e.id,label:e.name}})).filter(Boolean),n=e.map((function(e){return e.parentFunction&&e.parentFunction.id&&{value:e.id,label:e.name,parent:e.parentFunction.id}})).filter(Boolean),r=[],a={};return t.forEach((function(e){var t=e.value,l=n.filter((function(e){return e.parent===t}));r.push({value:e.value,label:e.label,indeterminate:!1,checkedList:[],checkAll:!1}),a[e.value]=l})),{result:r,resultChild:a}},A=function(e){var t=e.filter((function(e){return e.function&&e.function.parentFunction})).map((function(e){return{parentID:e.function.parentFunction.id,id:e.function.id}})),n=e.filter((function(e){return!e.function.parentFunction})).map((function(e){return e.function.id})),r={};return n.forEach((function(e){var n=t.map((function(t){if(t.parentID===e)return t.id})).filter(Boolean);r[e]=[].concat((0,o.default)(n),[e])})),r},B=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l={roleId:"domain"===n?t.role.id:t.id};s.Axios.post("roleFunction/findRoleFunctionList",l).then((function(t){if(!t.code){var n=A(t.data),l=t.data.reduce((function(e,t){return e[t.function.id]=t.id,e}),{}),u=e?a:j,i=(e?r:y).map((function(e){var t=n[e.value]?n[e.value]:[],r=0===u[e.value].length,a=t.length===u[e.value].length+1&&0!==t.length,l=a?!a:!!t.length&&t.length<u[e.value].length+1;return r&&1===t.length&&(a=!0,l=!1),g(g({},e),{},{checkedList:t,indeterminate:l,checkAll:a})}));I(l),O(i),x(t.data.map((function(e){return e.function.id})))}}))},L=function(e,t){W(e,t)},W=function(e,t){var n=y.map((function(n){if(n.value===t.value){if(0===e.length)return F(t,"delete"),g(g({},n),{},{checkedList:[],checkAll:!1,indeterminate:!1});if(e.length===j[t.value].length)return F(t,"add"),g(g({},n),{},{checkedList:e,checkAll:!0,indeterminate:!1});if(e.length<j[t.value].length)return F(t,"filterAdd",e),g(g({},n),{},{checkedList:e,checkAll:!1,indeterminate:!0})}return n}));O(n)},F=function(e,t,n){var r,a=j[e.value].map((function(e){return e.value})).filter(Boolean),l=[].concat((0,o.default)(a),[e.value]);if("add"===t)r=Array.from(new Set([].concat((0,o.default)(D),(0,o.default)(l))));else if("delete"===t)r=D.filter((function(e){return!l.includes(e)}));else{var u=D.filter((function(e){return!a.includes(e)}));r=Array.from(new Set([].concat((0,o.default)(u),(0,o.default)(n),[e.value])))}x(r)},T=function(e,t){var n=D.includes(t.value),r=y.map((function(e){if(e.value===t.value){if(F(t,n?"delete":"add"),n)return g(g({},e),{},{checkedList:[],checkAll:!1,indeterminate:!1});var r=j[t.value].map((function(e){return e.value})).filter(Boolean);return g(g({},e),{},{checkedList:r,checkAll:!0,indeterminate:!1})}return e}));O(r)},z=function(){B(),p(!1)},U=function(){var e={role:{id:"domain"===n?t.role.id:t.id},functionList:D};s.Axios.post("roleFunction/updateRoleAllFunction",e).then((function(e){0===e.code&&B(),p(!1)}))};return f.default.createElement("div",{className:"thoughtware_role_promisse"},i?f.default.createElement("div",{className:"thoughtware_role_promisse_up"},f.default.createElement(m.Btn,{onClick:z,isMar:!0},"取消"),f.default.createElement(m.Btn,{type:"primary",onClick:U},"保存")):f.default.createElement("div",{className:"thoughtware_role_promisse_up"},f.default.createElement(m.Btn,{onClick:function(){return p(!0)},icon:f.default.createElement(u.default,null)},"编辑")),f.default.createElement("div",{className:"thoughtware_role_promisse_table"},f.default.createElement(l.default,{pagination:!1,columns:M,dataSource:y,rowKey:function(e){return e.value},bordered:!0})),i&&f.default.createElement("div",{className:"thoughtware_role_promisse_bottom"},f.default.createElement(m.Btn,{onClick:z,isMar:!0},"取消"),f.default.createElement(m.Btn,{type:"primary",onClick:U},"保存")))}},683:function(e,t,n){"use strict";var r=n(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(216);var a=r(n(194)),l=r(n(192)),u=r(n(150)),i=r(n(0)),o=r(n(671));n(685);var c=["children"];t.default=function(e){var t=e.children,n=(0,u.default)(e,c),r=i.default.createElement(i.default.Fragment,null,i.default.createElement(o.default,{onClick:n.onCancel,title:"取消",isMar:!0}),i.default.createElement(o.default,{onClick:n.onOk,title:"确定",type:"primary"}));return i.default.createElement(a.default,(0,l.default)({style:{maxWidth:"calc(100vw - 120px)",maxHeight:"calc(100vh - 120px)",marginRight:"auto",marginLeft:"auto",position:"absolute",top:60,right:0,left:0,height:"100%",display:"flex",flexDirection:"column"},wrapClassName:"thoughtware_privilege_modal",closable:!1,destroyOnClose:!0,footer:r},n),t)}},684:function(e,t,n){"use strict";n.r(t)},685:function(e,t,n){"use strict";n.r(t)},686:function(e,t,n){"use strict";var r=n(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(45);var a=r(n(24)),l=r(n(217)),u=r(n(0));n(687);t.default=function(e){var t=e.firstItem,n=e.secondItem,r=e.children,i=e.onClick;return u.default.createElement("div",{className:"privilege-breadcrumb"},u.default.createElement(a.default,null,u.default.createElement("span",{className:i?"privilege-breadcrumb-first":"",onClick:i},i&&u.default.createElement(l.default,{style:{marginRight:8}}),u.default.createElement("span",{className:n?"privilege-breadcrumb-span":""},t)),n&&u.default.createElement("span",null," /   ",n)),u.default.createElement("div",null,r))}},687:function(e,t,n){"use strict";n.r(t)},688:function(e,t,n){"use strict";var r=n(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(304));n(195);var l=r(n(101)),u=r(n(0)),i=n(7);n(689);t.default=function(e){var t=e.userInfo,n=void 0===t?void 0:t,r=n||(0,i.getUser)();return u.default.createElement("div",{className:"thoughtware-profile"},r.avatar&&"null"!==r.avatar?u.default.createElement(l.default,{src:r.avatar}):r.nickname&&"null"!==r.nickname?u.default.createElement(l.default,null,r.nickname.substring(0,1)):r.name&&"null"!==r.name?u.default.createElement(l.default,null,r.name.substring(0,1)):u.default.createElement(l.default,{size:32,icon:u.default.createElement(a.default,null)}))}},689:function(e,t,n){"use strict";n.r(t)},690:function(e,t,n){"use strict";var r=n(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(303)),l=r(n(217)),u=r(n(0));n(691);t.default=function(e){var t=e.currentPage,n=e.changPage,r=e.page,i=r.totalPage,o=void 0===i?1:i,c=r.totalRecord,d=void 0===c?1:c;return o>1&&u.default.createElement("div",{className:"privilege-page"},u.default.createElement("div",{className:"".concat(1===t?"privilege-page-ban":"privilege-page-allow"),onClick:function(){return 1===t?null:n(t-1)}},u.default.createElement(l.default,null)),u.default.createElement("div",{className:"privilege-page-current"},t),u.default.createElement("div",{className:"privilege-page-line"}," / "),u.default.createElement("div",null,o),u.default.createElement("div",{className:"".concat(t===o?"privilege-page-ban":"privilege-page-allow"),onClick:function(){return t===o?null:n(t+1)}},u.default.createElement(a.default,null)),u.default.createElement("div",{className:"privilege-page-record"},"  共",d,"条 "))}},691:function(e,t,n){"use strict";n.r(t)},700:function(e,t,n){"use strict";var r=n(21),a=n(46);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(192));n(59);var u=r(n(39)),i=r(n(136));n(85);var o=r(n(42));n(118);var c=r(n(72)),d=r(n(149));n(45);var f=r(n(24));n(298);var s=r(n(137)),m=r(n(43)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=y(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),v=n(67),g=r(n(701)),b=n(637),h=n(135);function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(y=function(e){return e?n:t})(e)}t.default=(0,v.inject)(h.PRIVILEGE_DOMAIN_ROLE_STORE)((0,v.observer)((function(e){var t=e.dmRoleDetail,n=e.domainId,r=e.privilegeDomainRoleStore,a=r.deleteDmRoleUserAction,v=r.findDmRoleUserListAction,h=(0,p.useState)([]),y=(0,m.default)(h,2),O=y[0],E=y[1],P=(0,p.useState)(!1),j=(0,m.default)(P,2),_=j[0],w=j[1],k=[{title:"名称",dataIndex:"name",render:function(e,t){var n=t.user;return p.default.createElement(f.default,null,n.nickname,1===n.type&&p.default.createElement(s.default,null,"管理员用户"))}},{title:"类型",dataIndex:"type",render:function(e,t){t.user;return"用户"}},{title:"操作",dataIndex:"action",width:100,render:function(e,t){var n=t.user;return R(n.type,t)}}];(0,p.useEffect)((function(){null!=t&&t.id&&D()}),[null==t?void 0:t.id]);var D=function(){v({dmRoleId:t.id}).then((function(e){e.code||E(e.data)}))},x=function(e){a(e).then((function(e){e.code||D()}))},R=function(e,n){var r=t.businessType,a=[];return 0===r&&a.push(p.default.createElement(o.default,{title:"删除"},p.default.createElement(c.default,{placement:"topRight",title:"你确定删除吗",onConfirm:function(){return x(n.id)},okText:"确定",cancelText:"取消"},p.default.createElement(d.default,{style:{fontSize:"var(--thoughtware-icon-size-16)"}})))),r>0&&e<1&&a.push(p.default.createElement(o.default,{title:"删除"},p.default.createElement(c.default,{placement:"topRight",title:"你确定删除吗",onConfirm:function(){return x(n.id)},okText:"确定",cancelText:"取消"},p.default.createElement(d.default,{style:{fontSize:"var(--thoughtware-icon-size-16)"}})))),a};return p.default.createElement("div",{className:"thoughtware_dm_promisse"},p.default.createElement("div",{className:"thoughtware_dm_promisse_up"},p.default.createElement("div",{className:"thoughtware_dm_promisse_up-title"},"用户(",O.length,")"),p.default.createElement("div",null,p.default.createElement(b.Btn,{onClick:function(){return w(!0)},type:"primary",title:"添加用户",icon:p.default.createElement(i.default,null)}))),p.default.createElement("div",{className:"thoughtware_dm_promisse_person"},p.default.createElement(u.default,{columns:k,dataSource:O,rowKey:function(e){return e.id},pagination:!1})),p.default.createElement(g.default,(0,l.default)({},e,{visible:_,setVisible:w,getFindDmRoleUserList:D,dmRoleId:t.id,cardData:O,domainId:n})))})))},701:function(e,t,n){"use strict";var r=n(21),a=n(46);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(221)),u=r(n(43)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),o=r(n(679));function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}t.default=function(e){var t=e.visible,n=e.setVisible,r=e.dmRoleId,a=void 0===r?"":r,c=e.cardData,d=e.domainId,f=e.getFindDmRoleUserList,s=e.privilegeDomainRoleStore.createBatchDmRoleUserAction,m=(0,i.useState)([]),p=(0,u.default)(m,2),v=p[0],g=p[1],b=(0,i.useState)([]),h=(0,u.default)(b,2),y=h[0],O=h[1];(0,i.useEffect)((function(){t&&c&&(g(c.map((function(e){return e.user.id}))),O(c.map((function(e){return e.user.id}))))}),[t]);var E=function(){g([]),n(!1)};return i.default.createElement(o.default,{visible:t,addType:"domain",domainId:d,allSelectIds:y,selectedRowKeys:v,setSelectedRowKeys:g,handleOk:function(){s({dmRole:{id:a},domainId:d,userIds:v}).then((function(e){E(),f()}))},handleCancel:E},i.default.createElement("div",{className:"thoughtware_user_add_modal_up"},i.default.createElement("div",null,"添加用户"),i.default.createElement("div",{onClick:function(){return E()}},i.default.createElement(l.default,null))))}},731:function(e,t,n){"use strict";n.r(t)},740:function(e,t,n){"use strict";var r=n(675),a=n.n(r),l=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function u(e){var t={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},n=e.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(t.name=n[1],(a.a[n[1]]||"/"===e.charAt(e.length-2))&&(t.voidElement=!0),t.name.startsWith("!--"))){var r=e.indexOf("--\x3e");return{type:"comment",comment:-1!==r?e.slice(4,r):""}}for(var u=new RegExp(l),i=null;null!==(i=u.exec(e));)if(i[0].trim())if(i[1]){var o=i[1].trim(),c=[o,""];o.indexOf("=")>-1&&(c=o.split("=")),t.attrs[c[0]]=c[1],u.lastIndex--}else i[2]&&(t.attrs[i[2]]=i[3].trim().substring(1,i[3].length-1));return t}var i=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,o=/^\s*$/,c=Object.create(null);function d(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?function(e){var t=[];for(var n in e)t.push(n+'="'+e[n]+'"');return t.length?" "+t.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(d,"")+"</"+t.name+">";case"comment":return e+"\x3c!--"+t.comment+"--\x3e"}}var f={parse:function(e,t){t||(t={}),t.components||(t.components=c);var n,r=[],a=[],l=-1,d=!1;if(0!==e.indexOf("<")){var f=e.indexOf("<");r.push({type:"text",content:-1===f?e:e.substring(0,f)})}return e.replace(i,(function(i,c){if(d){if(i!=="</"+n.name+">")return;d=!1}var f,s="/"!==i.charAt(1),m=i.startsWith("\x3c!--"),p=c+i.length,v=e.charAt(p);if(m){var g=u(i);return l<0?(r.push(g),r):((f=a[l]).children.push(g),r)}if(s&&(l++,"tag"===(n=u(i)).type&&t.components[n.name]&&(n.type="component",d=!0),n.voidElement||d||!v||"<"===v||n.children.push({type:"text",content:e.slice(p,e.indexOf("<",p))}),0===l&&r.push(n),(f=a[l-1])&&f.children.push(n),a[l]=n),(!s||n.voidElement)&&(l>-1&&(n.voidElement||n.name===i.slice(2,-1))&&(l--,n=-1===l?r:a[l]),!d&&"<"!==v&&v)){f=-1===l?r:a[l].children;var b=e.indexOf("<",p),h=e.slice(p,-1===b?void 0:b);o.test(h)&&(h=" "),(b>-1&&l+f.length>=0||" "!==h)&&f.push({type:"text",content:h})}})),r},stringify:function(e){return e.reduce((function(e,t){return e+d("",t)}),"")}};t.a=f},745:function(e,t,n){"use strict";var r=n(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(746));t.default=a.default},746:function(e,t,n){"use strict";var r=n(21),a=n(46);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(88));n(73);var u=r(n(32)),i=r(n(192));n(74);var o=r(n(27));n(59);var c=r(n(39)),d=r(n(136)),f=r(n(89)),s=r(n(38));n(118);var m=r(n(72)),p=r(n(149));n(85);var v=r(n(42)),g=r(n(486));n(45);var b=r(n(24));n(298);var h=r(n(137)),y=r(n(43)),O=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),E=n(67),P=n(44),j=n(747),_=n(637);function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(731);t.default=(0,E.inject)("privilegeDomainRoleStore")((0,E.observer)((function(e){var t=(0,P.useTranslation)().t,n=e.privilegeDomainRoleStore,r=e.domainId,a=n.privilegeDomainRole,s=n.deleteDomainRoleAction,E=n.setDomainRoleAction,w=n.findDomainRolePageAction,k=n.domainRolePage,x=(0,O.useState)(!1),R=(0,y.default)(x,2),S=R[0],I=R[1],M=(0,O.useState)({pageSize:12,currentPage:1}),C=(0,y.default)(M,1)[0],N=(0,O.useState)({pageParam:C}),A=(0,y.default)(N,2),B=A[0],L=A[1],W=(0,O.useState)(null),F=(0,y.default)(W,2),T=F[0],z=F[1],U=[{title:"角色名称",dataIndex:"name",width:"40%",ellipsis:!0,render:function(e,t){var n=t.businessType,r=t.role;return 1===n&&1===r.defaultRole?O.default.createElement(b.default,null,O.default.createElement("div",{className:"thoughtware_domain_role_name",onClick:function(){return G(t)}},r.name),O.default.createElement(h.default,{color:"#87d068"},"默认"),O.default.createElement(h.default,null,"管理员")):1===r.defaultRole?O.default.createElement(b.default,null,O.default.createElement("div",{className:"thoughtware_domain_role_name",onClick:function(){return G(t)}},r.name),O.default.createElement(h.default,{color:"#87d068"},"默认")):1===n?O.default.createElement(b.default,null,O.default.createElement("div",{className:"thoughtware_domain_role_name",onClick:function(){return G(t)}},r.name),O.default.createElement(h.default,null,"管理员")):O.default.createElement("div",{className:"thoughtware_domain_role_name",onClick:function(){return G(t)}},r.name)}},{title:"成员数",dataIndex:"roleUserList",width:"25%",ellipsis:!0,render:function(e,t){var n=t.dmRoleUserList,r=n&&n.length>0?n.length:0;return"".concat(r,"人")}},{title:"角色类型",dataIndex:["role","group"],width:"25%",ellipsis:!0,render:function(e){return"system"===e?"内置":t("privilege-role.custom")}},{title:"操作",dataIndex:"action",render:function(e,t){var n=t.role,r=t.businessType,a=t.id;return O.default.createElement(b.default,null,0===(null==n?void 0:n.defaultRole)&&O.default.createElement(v.default,{title:"设置默认"},O.default.createElement(g.default,{onClick:function(){return V(t)},style:{fontSize:"var(--thoughtware-icon-size-16)"}})),0===r&&"system"!==n.group&&O.default.createElement(v.default,{title:"删除"},O.default.createElement(m.default,{placement:"topRight",title:"你确定删除吗",onConfirm:function(){return J(a)},okText:"确定",cancelText:"取消"},O.default.createElement(p.default,{style:{fontSize:"var(--thoughtware-icon-size-16)"}}))))}}];(0,O.useEffect)((function(){K()}),[B]);var K=function(){w(D(D({},B),{},{domainId:r}))},V=function(){var e=(0,f.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t);case 2:e.sent.code||K();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(e){z(e)},J=function(){var e=(0,f.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:0===e.sent.code&&K();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return O.default.createElement(u.default,{className:"thoughtware_domain_role"},O.default.createElement(o.default,{sm:{span:"24"},md:{span:"24"},lg:{span:"24"},xl:{span:"18",offset:"3"},xxl:{span:"18",offset:"3"}},T?O.default.createElement(j.DmRoleDetail,{roleDetailParams:T,domainId:r,setDetail:z,getProjectDmRole:K}):O.default.createElement("div",{className:"thoughtware_domain_role-content"},O.default.createElement(_.BreadCrumb,{firstItem:"权限"},O.default.createElement(_.Btn,{onClick:function(){return I(!0)},type:"primary",icon:O.default.createElement(d.default,null),title:t("privilege-role.addRole")})),O.default.createElement(c.default,{columns:U,dataSource:a,rowKey:function(e){return e.id},pagination:!1}),O.default.createElement(_.Page,{currentPage:B.pageParam.currentPage,changPage:function(e){L(D(D({},B),{},{pageParam:{pageSize:12,currentPage:e}}))},page:k}))),O.default.createElement(j.DmRoleCreate,(0,i.default)({},e,{visible:S,domainId:r,handleCancel:function(){return I(!1)},getProjectDmRole:K})))})))},747:function(e,t,n){"use strict";var r=n(21);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DmRoleCreate",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"DmRoleDetail",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"DmRolePeople",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"DomainRoleUserCreate",{enumerable:!0,get:function(){return i.default}});var a=r(n(748)),l=r(n(749)),u=r(n(700)),i=r(n(701))},748:function(e,t,n){"use strict";var r=n(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(50);var a=r(n(18)),l=r(n(38));n(60);var u=r(n(15)),i=r(n(43)),o=r(n(0)),c=n(44),d=n(637);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(e){var t=e.visible,n=e.handleCancel,r=e.getProjectDmRole,l=e.domainId,f=e.privilegeDomainRoleStore.createDomainRoleAction,m=(0,c.useTranslation)().t,p=u.default.useForm(),v=(0,i.default)(p,1)[0];return o.default.createElement(d.BaseModal,{title:"添加角色",visible:t,onCancel:n,onOk:function(){v.submit()},destroyOnClose:!0},o.default.createElement(u.default,{form:v,preserve:!1,onFinish:function(e){var t={domainId:l,businessType:0,role:s({},e)};f(t).then((function(e){0===e.code&&(n(),r())}))},layout:"vertical"},o.default.createElement(u.default.Item,{label:m("privilege-role.roleName"),name:"name",rules:[{required:!0,message:"用户名不能包含非法字符，如&,%，&，#……等"}]},o.default.createElement(a.default,{placeholder:m("privilege-role.roleName")})),o.default.createElement(u.default.Item,{label:m("privilege-desc"),name:"desc"},o.default.createElement(a.default,{placeholder:m("privilege-desc")}))))}},749:function(e,t,n){"use strict";var r=n(21),a=n(46);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(192));n(50);var u=r(n(18)),i=r(n(38)),o=r(n(43));n(302);var c=r(n(138)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,n&&n.set(e,r),r}(n(0)),f=n(44),s=r(n(700)),m=n(637),p=r(n(680)),v=n(7);function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=c.default.TabPane;t.default=function(e){var t,n,r,a,g=e.roleDetailParams,b=e.domainId,O=e.setDetail,E=e.getProjectDmRole,P=(0,f.useTranslation)().t,j=(0,d.useState)(null),_=(0,o.default)(j,2),w=_[0],k=_[1],D=function(e,t){if(k(null),g.role[t]!==e.target.value){e.target.value||"name"!==t||O(g);var n=g.role,r={domainId:b,id:g.id,role:h(h({},n),{},(0,i.default)({},t,e.target.value))};v.Axios.post("/dmRole/updateDmRole",r).then((function(r){0===r.code&&(O(h(h({},g),{},{role:h(h({},n),{},(0,i.default)({},t,e.target.value))})),E())}))}};return d.default.createElement("div",{className:"thoughtware_domain_role_detail"},d.default.createElement(m.BreadCrumb,{firstItem:(null==g||null===(t=g.role)||void 0===t?void 0:t.name)||"权限详情",onClick:function(){return O(null)}}),d.default.createElement("div",{className:"detail-title"},d.default.createElement("div",{className:"label_item"},d.default.createElement("div",null,"名称"),d.default.createElement("div",null,d.default.createElement(u.default,{bordered:"name"===w,defaultValue:null==g||null===(n=g.role)||void 0===n?void 0:n.name,className:"".concat("name"===w?"":"label_item_name"),onFocus:function(){return k("name")},onBlur:function(e){return D(e,"name")},onPressEnter:function(e){return e.target.blur()}}))),d.default.createElement("div",{className:"label_item"},d.default.createElement("div",null,"类型"),d.default.createElement("div",{className:"label_item_type"},"system"===(null==g||null===(r=g.role)||void 0===r?void 0:r.group)?"内置":"自定义"))),d.default.createElement("div",{className:"label_item label_desc"},d.default.createElement("div",null,"描述"),d.default.createElement("div",null,d.default.createElement(u.default.TextArea,{bordered:"desc"===w,defaultValue:null==g||null===(a=g.role)||void 0===a?void 0:a.desc,className:"".concat("desc"===w?"":"label_item_name"),onFocus:function(){return k("desc")},onBlur:function(e){return D(e,"desc")},autoSize:{minRows:1,maxRows:4}}))),d.default.createElement(c.default,{defaultActiveKey:"people"},d.default.createElement(y,{tab:P("privilege-role.people"),key:"people"},d.default.createElement(s.default,(0,l.default)({},e,{domainId:b,dmRoleDetail:g}))),d.default.createElement(y,{tab:P("privilege-role.promise"),key:"promise"},d.default.createElement(p.default,{type:"domain",roleDetail:g}))))}},970:function(e,t,n){"use strict";n(731)}}]);